# migrations/ Overview

## Purpose
This folder contains all database migration files generated by Drizzle Kit from the schema definitions in `/src/lib/db/schema.ts`. These migrations track the evolution of the database schema over time and ensure consistent database structure across all environments.

## Contents
- **SQL Migration Files** (`0000_*.sql` to `0006_*.sql`): Sequential migration files containing DDL statements
- **meta/**: Migration metadata and snapshots for Drizzle Kit internal tracking
  - `*_snapshot.json`: Schema snapshots at each migration point
  - `_journal.json`: Migration history and sequencing information

## Patterns & Conventions
- **Sequential Numbering**: Migrations use a 4-digit prefix (0000, 0001, etc.)
- **Descriptive Names**: Each migration has a randomly generated memorable name (e.g., `late_war_machine`)
- **Idempotent Migrations**: Migrations should be safe to run multiple times
- **Forward-Only**: No down migrations; schema changes are append-only
- **Auto-Generated**: All migrations are generated via `bun run db:generate`

## Dependencies
- **Internal dependencies**: 
  - `/src/lib/db/schema.ts` - Source schema definitions
  - `/drizzle.config.ts` - Drizzle configuration
- **External dependencies**: 
  - `drizzle-kit` - Migration generation and management
  - `drizzle-orm` - ORM runtime

## Key Files
- `0000_late_war_machine.sql`: Initial database schema setup
- `0001_stormy_azazel.sql`: First schema update
- `0002_blue_payback.sql`: Second schema update
- `0003_pale_blizzard.sql`: Third schema update
- `0004_dear_doctor_octopus.sql`: Fourth schema update
- `0005_sharp_lady_mastermind.sql`: Fifth schema update
- `0006_motionless_lilandra.sql`: Latest schema update
- `meta/_journal.json`: Migration execution journal

## Related Documentation
- [üìö Database Architecture: /docs/architecture/database.md]
- [üîó Schema Documentation: /docs/references/database-schema.md]
- [üèóÔ∏è Migration Guide: /docs/guides/database-migrations.md]

## Quick Start
```bash
# Generate a new migration from schema changes
bun run db:generate

# Apply pending migrations to database
bun run db:migrate

# Push schema changes directly (development only)
bun run db:push

# Open Drizzle Studio for database inspection
bun run db:studio
```

## Notes
- Never manually edit migration files after they've been applied
- Always review generated migrations before applying to production
- The meta/ folder is managed by Drizzle Kit and should not be edited manually
- Migration files are append-only; to fix issues, create new migrations
- Each migration captures a complete snapshot of the schema at that point in time